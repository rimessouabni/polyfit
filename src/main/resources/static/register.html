<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PolyFit - Register</title>
    <!-- Include Tailwind CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>

  <body class="bg-gray-100">
    <div class="flex items-center justify-center h-screen">
      <div class="login-container bg-white shadow-md p-8 w-100">
        <h2 class="text-2xl font-bold mb-4 pt-4 text-center">
          Create a profile at Polytech
        </h2>
        <form
          id="inscription-form"
          class="space-y-4 flex flex-col items-center justify-center"
        >
          <div>
            <label for="nom" class="text-sm">Username </label>
            <input
              type="text"
              id="nom"
              name="nom"
              required
              class="w-full bg-gray-100 border-2 rounded-md px-20 py-2"
            />
          </div>

          <div class="flex flex-wrap space-x-4">
            <div>
              <label for="email" class="text-sm">Mail </label>
              <input
                type="email"
                id="email"
                name="email"
                required
                class="w-full bg-gray-100 border-2 rounded-md px-20 py-2"
              />
            </div>

            <div>
              <label for="motdepasse" class="text-sm">Password </label>
              <input
                type="password"
                id="motdepasse"
                name="motdepasse"
                required
                class="w-full bg-gray-100 border-2 rounded-md px-20 py-2"
              />
            </div>
          </div>

          <div>
            <label for="dateOfBirth" class="text-sm">Date of Birth </label>
            <input
              type="date"
              id="dateOfBirth"
              name="dateOfBirth"
              required
              class="w-full bg-gray-100 border-2 rounded-md px-10 py-2"
            />
          </div>

          <div>
            <label for="objectifs" class="block">Goals</label>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div
                class="bg-white rounded-lg border-2 p-4 cursor-pointer"
                onclick="selectOption('Musculation', this)"
              >
                <input
                  type="hidden"
                  name="objectif"
                  id="objectif1"
                  value="Musculation"
                />
                <img
                  src="./images/fitness.png"
                  alt="Musculation"
                  class="w-full h-32 object-cover rounded-md mb-2"
                />
                <p class="text-center font-semibold">Weightlifting</p>
              </div>
              <div
                class="bg-white rounded-lg p-4 border-2 cursor-pointer"
                onclick="selectOption('Cardio', this)"
              >
                <input
                  type="hidden"
                  name="objectif"
                  id="objectif2"
                  value="Cardio"
                />
                <img
                  src="./images/running.png"
                  alt="Cardio"
                  class="w-full h-32 object-cover rounded-md mb-2"
                />
                <p class="text-center font-semibold">Cardio</p>
              </div>
              <div
                class="bg-white rounded-lg p-4 border-2 cursor-pointer"
                onclick="selectOption('Flexibilité', this)"
              >
                <input
                  type="hidden"
                  name="objectif"
                  id="objectif3"
                  value="Flexibilité"
                />
                <img
                  src="./images/meditation.png"
                  alt="Flexibilité"
                  class="w-full h-32 object-cover rounded-md mb-2"
                />
                <p class="text-center font-semibold">Flexibility</p>
              </div>
            </div>
          </div>

          <div>
            <label for="niveau" class="text-sm">Physical Fitness Level </label>
            <select
              id="niveau"
              name="niveau"
              class="w-full border-2 rounded-md bg-gray-100 px-2 py-2"
            >
              <option value="debutant">Beginner</option>
              <option value="intermediaire">Intermediate</option>
              <option value="avance">Advanced</option>
            </select>
          </div>

          <button
            type="submit"
            class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded"
          >
            S'inscrire
          </button>
          <p class="text-gray-700 text-sm mt-4">
            Already have an account?
            <a href="/login.html" class="text-blue-700 underline">Log in here</a
            >.
          </p>
        </form>
      </div>
    </div>

    <script>
      function selectOption(option, element) {
        const prevSelected = document.querySelector(".border-blue-500");
        if (prevSelected) {
          prevSelected.classList.remove("border-blue-500");
        }
        element.classList.add("border-blue-500");
        document.getElementById("objectif").value = option;
      }

      document
        .getElementById("inscription-form")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent the default form submission

          // Get form data
          const formData = new FormData(event.target);

          // Convert form data to JSON object
          const userData = {
            username: formData.get("nom"),
            email: formData.get("email"),
            password: formData.get("motdepasse"),
            dateOfBirth: formData.get("dateOfBirth"),
            objectif: formData.get("objectif"),
          };

          // Send POST request to your backend API
          fetch("/add-user", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(userData),
          })
            .then((response) => response.json()) // Parse response JSON
            .then((data) => {
              if (data.success) {
                alert("Inscription réussie !");
                window.location.href = "/login.html"; // Redirect to login page
              } else {
                alert("Erreur lors de l'inscription.");
              }
            })
            .catch((error) => {
              console.error("Erreur lors de l'inscription:", error);
              alert("Erreur lors de l'inscription.");
            });
        });
    </script>
  </body>
</html>
